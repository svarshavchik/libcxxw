<!--

Copyright 2019 Double Precision, Inc.
See COPYING for distribution information.

-->

<appendix id="uixmldoc">
  <title>&appshort; theme files</title>

  <para>
    A theme UI file automates creation of widgets from an
    <acronym>XML</acronym> document, which
    <link linkend="uixmlgenerate">generates
      the contents of a &layoutmanager; or a factory</link>. The theme UI
    file also creates several supporting objects:
    <link linkend="uixmldimcolorborders"><tag class='element'>dim</tag>s,
      <tag class='element'>color</tag>s,
      and
      <tag class='element'>border</tag>s</link>; as well as custom
    <link linkend="uixmlappearance">appearance objects</link>.
  </para>

  <blockquote>
    <informalexample>
      <programlisting><![CDATA[
<?xml version="1.0" encoding="utf-8"?>
<theme version="1"
       xmlns:xi="http://www.w3.org/2003/XInclude">

  <layout type="grid" id="main-window-grid">

    <!-- ... -->

  </layout>

  <factory type="grid" id="button-row">

    <!-- ... -->

  </layout>

  <layout type="book" id="formatting-options">


    <!-- ... -->

  </layout>

  <factory type="book" id="formatting-generic-options">

    <!-- ... -->

  </layout>
</theme>
]]></programlisting>
    </informalexample>
  </blockquote>

  <para>
    The <acronym>XML</acronym> document's root widget is a
    <tag class='element'>theme</tag>
    widget. For future compatibility, its
    <tag class='attribute'>version</tag> attribute should be 1.
    The
    <tag class='element'>theme</tag>
    widget contains
    <tag class='element'>layout</tag>
    and
    <tag class='element'>factory</tag>
    elements. Their
    <tag class='attribute'>id</tag> attributes must be unique, and serve
    as means of referring to each
    <tag class='element'>layout</tag>
    and
    <tag class='element'>factory</tag>
    widget by name.
    Only the first
    <tag class='element'>layout</tag>
    and
    <tag class='element'>factory</tag>
    with a unique id takes effect, second and subsequent
    <tag class='element'>layout</tag>s
    and
    <tag class='element'>factory</tag>s
    with the same
    <tag class='attribute'>id</tag>
    get ignored.
    In all other respects the relative order of
    <tag class='element'>layout</tag>s
    and
    <tag class='element'>factory</tag>s
    doesn't matter,
    and
    together with <application>XInclude</application> this makes it possible
    to implement to create a theme file with shared
    <tag class='element'>layout</tag>s
    and
    <tag class='element'>factory</tag>s, and then
    include it from other theme files, extending and/or
    overriding parts of it.
  </para>

  <para>
    The theme file's <acronym>XML</acronym> document also contains several other
    elements, like
    <link linkend="uixmldimcolorborders"><tag class='element'>dim</tag>s,
      <tag class='element'>color</tag>s,
      <tag class='element'>border</tag>s</link>,
    and
    <link linkend="uixmlappearance"><tag class='element'>appearance</tag></link>,
    with their own
    <tag class='attribute'>id</tag>s that work the same way.
  </para>

  <para>
    The widget contents of <tag class='element'>layout</tag>s or a
    <tag class='element'>factory</tag>s depend on their
    <tag class='attribute'>type</tag>.
    The widget content effectively translates to invoking the corresponding
    methods of a &layoutmanager; or a &factory;:
  </para>

  <variablelist>
    <varlistentry>
      <term>
	<tag class='element'>layout</tag>s with a
	<tag class='attribute'>type</tag> of <literal>grid</literal>.
      </term>
      <listitem>
	<para>
	  The widget contents of this layout invoke the corresponding
	  methods of a
	  <ulink url="&link-typedef-x--w-gridlayoutmanager;">grid
	    layout manager</ulink>.
	</para>
      </listitem>
    </varlistentry>

    <varlistentry>
      <term>
	<tag class='element'>layout</tag>s with a
	<tag class='attribute'>type</tag> of <literal>book</literal>.
      </term>
      <listitem>
	<para>
	  The widget contents of this layout invoke the corresponding
	  methods of a
	  <ulink url="&link-typedef-x--w-booklayoutmanager;">book
	    layout manager</ulink>.
	</para>
      </listitem>
    </varlistentry>

    <varlistentry>
      <term>
	<tag class='element'>factory</tag>s with a
	<tag class='attribute'>type</tag> of <literal>grid</literal>.
      </term>
      <listitem>
	<para>
	  The widget contents of this layout invoke the corresponding
	  methods of a
	  <ulink url="&link-typedef-x--w-gridfactory;">grid
	    factory</ulink>.
	</para>
      </listitem>
    </varlistentry>

    <varlistentry>
      <term>
	<tag class='element'>factory</tag>s with a
	<tag class='attribute'>type</tag> of <literal>book</literal>.
      </term>
      <listitem>
	<para>
	  The widget contents of this layout invoke the corresponding
	  methods of a
	  <ulink url="&link-typedef-x--w-bookpagefactory;">book page
	    factory</ulink>.
	</para>
      </listitem>
    </varlistentry>
  </variablelist>

  <section id="uixmlgenerate">
    <title>Creating generic widgets using named callbacks</title>

    <blockquote>
      <informalexample>
	<programlisting>
#include &lt;&ns;/w/uielements.H&gt;
#include &lt;&ns;/w/uigenerators.H&gt;

&ns;::w::gridlayoutmanager grid_layout=container->get_layoutmanager();

&ns;::w::const_uigenerators generators=&ns;::w::uigenerators::create("layouts.xml");

&ns;::w::labelptr created_label;
&ns;::w::buttonptr created_button;

&ns;::w::uielements creators{
    {
          {"label",
           [&amp;]
           (const INSERT_LIBX_NAMESPACE::w::factory &amp;f)
           {
               created_label=f->create_label("Lorem ipsum");
           }
          },
          {"button",
           [&amp;]
           (const INSERT_LIBX_NAMESPACE::w::factory &amp;f)
           {
               created_button=f->create_button("Lorem ipsum");
           }
          },
    }
};</programlisting>
      </informalexample>
    </blockquote>

    <para>
      Creating widgets using a theme file
      is a three step process:
    </para>

    <orderedlist>
      <listitem>
	<para>
	  <methodname>create</methodname>() an
	  <ulink url="&link-typedef-x--w-uigenerators;"><classname>&ns;::w::const_uigenerators</classname></ulink>
	  object.
	  This loads the theme file and effectively
	  compiles it into an internal representation, a
	  <ulink url="&refobj;">reference-counted object</ulink>.
	  <methodname>create</methodname>() returns a
	  <classname>&ns;::w::const_uigenerators</classname> handle, a
	  <ulink url="&constrefobj;">reference to a
	    <literal>const</literal> object</ulink> object (the compiled
	  theme file object remains constant after it's created).
	</para>
      </listitem>

      <listitem>
	<para>
	  Create an
	  <ulink url="&link-x--w--uielements;"><classname>&ns;::w::uielements</classname></ulink>
	  object.
	  The
	  <classname>&ns;::w::uielements</classname>
	  gets created in automatic scope, and this individual object
	  is no longer required after the widgets get
	  <methodname>generate</methodname>()d.
	  The
	  <classname>&ns;::w::const_uigenerators</classname>
	  contains multiple layout specifications, is constant, and can
	  be used multiple times.
	</para>

	<para>
	  <classname>&ns;::w::uielements</classname>'s first member,
	  <varname>factories</varname> is a map. The map key's is a
	  text string, a label. The keys' values are lambdas, or callable
	  objects. The lambdas receive a &factory; as their parameter.
	  It's expected that each lambda uses the factory to create a single
	  widget.
	</para>
      </listitem>

      <listitem>
	<para>
	  Invoke a layout manager's
	  <methodname>generate</methodname>() to execute the compiled
	  theme file, and create its contents.
	</para>

	<blockquote>
	  <informalexample>
	    <programlisting>
grid_layout->generate("main-window-grid", generator, creators);</programlisting>
	  </informalexample>
	</blockquote>
	<para>
	  A <link linkend="gridlayoutmanager">grid layout manager</link>'s
	  <methodname>generate</methodname>() generates the contents of the
	  contents of the layout manager from the theme file. The
	  first parameter gives the name of a
	  <tag class='element'>layout</tag> whose
	  <tag class='attribute'>type</tag> must be
	  <quote>grid</quote>, and have a matching
	  <tag class='type'>id</tag> (<quote>main-window-grid</quote>, in
	  this example).
	  This executes the specification for this
	  <tag class='element'>layout</tag> from the compiled theme file.
	</para>
      </listitem>
    </orderedlist>
  </section>

  <section id="uixmlwidgets">
    <title>Creating widgets directly from an <acronym>XML</acronym>
      theme file</title>

    <para>
      It's always possible to <link linkend="wordwraplabel">create
	label widgets</link>
      by specifying a <tag class='element'>name</tag>d
      <tag class='element'>element</tag> in the theme file,
      and implementing the named
      <classname>&ns;::w::uielements</classname> callback when
      <link linkend="uixmlgenerate">generating the widgets</link>.
    </para>

    <para>
      It is possible to create some widgets directly from a specific in the
      <acronym>XML</acronym> theme file.
      <ulink url="examples/uigenerator4.C"><filename>uigenerator4.C</filename></ulink>
      gives an example of
      <link linkend="uixmlfactorylabelelement">creating label widgets</link>
      from the theme file.
      This example creates the same label widget
      <link linkend="wordwraplabel">wordwraplabel.C</link>, but this
      approach makes it possible to tweak labels without recompiling the code.
    </para>

    <blockquote>
      <title><ulink url="examples/uigenerator4.xml">uigenerator4.xml</ulink></title>

      <informalexample>
	<programlisting><xi:include href="../examples/uigenerator4.xml" parse="text" xmlns:xi="http://www.w3.org/2001/XInclude" /></programlisting>
      </informalexample>
    </blockquote>

    <para>
      The contents of the
      <tag class='element'>label</tag> is a
      <ulink url="&link-x--w--theme-text;"><classname>&ns;::w::theme_text</classname></ulink>
      with references to colors and fonts defined in the theme file or the
      default display theme.
    </para>
  </section>

  <section id="uixmldimcolorborders">
    <title><tag class='element'>dim</tag>s,
      <tag class='element'>color</tag>s,
      and
      <tag class='element'>border</tag>s</title>
    <blockquote>
      <informalexample>
	<programlisting><![CDATA[
<dim id="border-size">2.0</dim>

<color id="left-border-color">
  <r>1</r>
  <g>.5</g>
  <b>.0</b>
</color>

<border id="solid-border">
  <color>left-border-color</color>
  <width>border-size</width>
  <height>border-size</height>
</border>]]></programlisting>
      </informalexample>
    </blockquote>

    <para>
      <tag class='element'>dim</tag>ensions specify sizes of various UI
      elements,
      A <tag class='element'>dim</tag> widget specifies a size in millimeters,
      which can be fractional, and calculates the number of pixels closest
      to the given size, taking into account the
      <link linkend="cxxwtheme.1">current theme's scale</link>.
      This is the same as setting a
      <ulink url="&link-typedef-x--w-dim-arg;"><classname>&ns;::w::dim_arg</classname></ulink>
      from the given value.
    </para>

    <para>
      <tag class='element'>color</tag>s define colors in terms of their
      <tag class='element'>r</tag>ed,
      <tag class='element'>g</tag>green,
      <tag class='element'>b</tag>blue, and
      <tag class='element'>a</tag>alpha (transparency) values.
      Each component ranges from 0 (none) to 1.0 (maximum intensity).
      This is the same as setting
      <ulink url="&link-typedef-x--w-color-arg;"><classname>&ns;::w::color_arg</classname></ulink>
      from an
      <ulink url="&link-x--w--rgb;"><classname>&ns;::w::rgb</classname></ulink>
      whose values are scaled from 0 to
      <literal>&ns;::w::rgb::maximum</literal> with <literal>1.0</literal>
      as <literal>&ns;::w::rgb::maximum</literal>.
    </para>

    <para>
      Other parts of the theme file refer to dimensions and colors by their
      <tag class='type'>id</tag>s:
    </para>

    <blockquote>
      <informalexample>
	<programlisting><![CDATA[
<border id="solid-border">
  <color>left-border-color</color>
  <width>border-size</width>
  <height>border-size</height>
</border>]]></programlisting>
      </informalexample>
    </blockquote>

    <para>
      A <tag class='element'>border</tag> widget defines a border,
      effectively initializing a
      <ulink url="&link-typedef-x--w-border-arg;"><classname>&ns;::w::border_arg</classname></ulink>
      from a
      <ulink url="&link-x--w--border-infomm;"><classname>&ns;::w::border_infomm</classname></ulink>.

      The <tag class='element'>border</tag> contains the following elements:
    </para>
    <variablelist>
      <varlistentry>
	<term><tag class='element'>width</tag></term>
	<listitem>
	  <para>
	    This <tag class='element'>dim</tag>ension sets
	    <classname>&ns;::w::border_infomm</classname>'s
	    <varname>width</varname>.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><tag class='element'>height</tag></term>
	<listitem>
	  <para>
	    This <tag class='element'>dim</tag>ension sets
	    <classname>&ns;::w::border_infomm</classname>'s
	    <varname>height</varname>.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><tag class='element'>rounded</tag></term>
	<listitem>
	  <blockquote>
	    <informalexample>
	      <programlisting><![CDATA[
<rounded />

<rounded>1</rounded>

<rounded>0</rounded>]]></programlisting>
	    </informalexample>
	  </blockquote>

	  <para>
	    This sets
	    <classname>&ns;::w::border_infomm</classname>'s
	    <varname>rounded</varname> (an empty tag is equivalent to 1).
	  </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term><tag class='element'>hradius</tag></term>
	<listitem>
	  <para>
	    This <tag class='element'>dim</tag>ension sets
	    <classname>&ns;::w::border_infomm</classname>'s
	    <varname>hradius</varname>.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><tag class='element'>vradius</tag></term>
	<listitem>
	  <para>
	    This <tag class='element'>dim</tag>ension sets
	    <classname>&ns;::w::border_infomm</classname>'s
	    <varname>vradius</varname>.
	  </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term><tag class='element'>width_scale</tag>,
	  <tag class='element'>height_scale</tag>,
	  <tag class='element'>hradius_scale</tag>, and
	  <tag class='element'>vradius_scale</tag></term>
	<listitem>
	  <para>
	    These elements' values set
	    <classname>&ns;::w::border_infomm</classname>'s
	    corresponding members.
	  </para>
	</listitem>
      </varlistentry>


      <varlistentry>
	<term><tag class='element'>color</tag></term>
	<listitem>
	  <para>
	    This <tag class='element'>color</tag>ension sets
	    <classname>&ns;::w::border_infomm</classname>'s
	    <varname>color1</varname>.
	    This is the border's primary color.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><tag class='element'>color2</tag></term>
	<listitem>
	  <para>
	    This <tag class='element'>color</tag>ension sets
	    <classname>&ns;::w::border_infomm</classname>'s
	    <varname>color2</varname>.
	    This is an optional secondary color for drawing dashed
	    borders.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><tag class='element'>dash</tag></term>
	<listitem>
	  <para>
	    This widget can appear more than once, and initializes
	    <classname>&ns;::w::border_infomm</classname>'s
	    <varname>dashes</varname>. This creates a border that's drawn as
	    a dashed line instead of a solid
	    <tag class='element'>color</tag>.
	  </para>
	</listitem>
      </varlistentry>
    </variablelist>

    <section id="uixmldefaultthemevalues">
      <title>Using <tag class='element'>dim</tag>s,
	<tag class='element'>color</tag>s,
	and
	<tag class='element'>border</tag>s from the default theme</title>

      <para>
	Like with all other elements, the relative order of
	<tag class='element'>dim</tag>s,
	<tag class='element'>color</tag>s,
	and
	<tag class='element'>border</tag>s, relative to each other and other
	elements in the theme file, does not matter, except that the first
	unique
	<tag class='attribute'>id</tag> takes priority over other elements
	with the same
	<tag class='attribute'>id</tag> which get ignored.
      </para>

      <para>
	<tag class='attribute'>id</tag>s that are not defined in the theme
	file are presumed to be referring to the ones specifies by the
	<link linkend="cxxwtheme.1">current default theme</link>.
      </para>
    </section>

    <section id="uixmlderivedvalues">
      <title>Derived<tag class='element'>color</tag>s,
	and
	<tag class='element'>border</tag>s</title>

      <para>
	All theme files can reference the following
	<tag class='element'>color</tag>s:
	<quote>transparent</quote>, with 0
	<tag class='element'>r</tag>,
	<tag class='element'>g</tag>,
	<tag class='element'>b</tag>, and
	<tag class='element'>a</tag> values, and the following standard
	<acronym>HTML</acronym> 3.2 colors:
	<quote><literal>black</literal></quote>,
	<quote><literal>gray</literal></quote>,
	<quote><literal>silver</literal></quote>,
	<quote><literal>white</literal></quote>,
	<quote><literal>maroon</literal></quote>,
	<quote><literal>red</literal></quote>,
	<quote><literal>olive</literal></quote>,
	<quote><literal>yellow</literal></quote>,
	<quote><literal>green</literal></quote>,
	<quote><literal>lime</literal></quote>,
	<quote><literal>teal</literal></quote>,
	<quote><literal>aqua</literal></quote>,
	<quote><literal>navy</literal></quote>,
	<quote><literal>blue</literal></quote>,
	<quote><literal>fuchsia</literal></quote>,
	<quote><literal>purple</literal></quote>.
      </para>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<color id="bgcolor" scale="gray" />

<color id="bgcolor2" scale="gray">
  <r>1.2</r>
</color>

<border id="dashed-border" from="solid-border">

  <color>green</color>
  <color2>blue</color2>
  <dash>.75</dash>
  <rounded>1</rounded>
</border>

]]>
	  </programlisting>
	</informalexample>
      </blockquote>

      <para>
	Declaring a
	<tag class='element'>color</tag> with a
	<tag class='type'>scale</tag> attribute creates a new alias for another
	color in the theme file. This copies the
	<tag class='element'>r</tag>,
	<tag class='element'>g</tag>,
	<tag class='element'>b</tag>, and
	<tag class='element'>a</tag> values from the other color, and
	multiplies them by the values in the scaled alias, if specified.
	The above example creates a <literal>bgcolor2</literal> from a
	<literal>bgcolor</literal>, with the
	<tag class='element'>r</tag>ed component multiplied by 1.2 (20%
	higher red channel). The scaled component values get automatically
	truncated to the range of 0 to 1.
      </para>

      <para>
	Similarly, declaring a
	<tag class='element'>border</tag> with a
	<tag class='type'>from</tag> attribute creates a new border based
	on another border, with any given values replacing the values from
	the other border, with one exception: declaring a new color
	<tag class='element'>color</tag> replaces the
	<tag class='element'>color</tag> from the original border, and resets
	the new border's <tag class='element'>color2</tag>, unless the new
	border also specifies an explicit <tag class='element'>color2</tag>;
	and specifying the new border's <tag class='element'>color2</tag>
	requires
	explicitly specifying its <tag class='element'>color</tag>, also.
      </para>
      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<border id="solid-border" from="dashed-border">

  <dash/>
  <rounded>0</rounded>
</border>]]>
	  </programlisting>
	</informalexample>
      </blockquote>
      <para>
	An empty <tag class='element'>dash</tag> in a derived
	<tag class='element'>border</tag> removes the inherited dashes.
      </para>
    </section>

  </section>
  <section id="uixmldimcolorgradients">
    <title>Gradient <tag class='element'>color</tag>s</title>

    <para>
      Color gradients are allowed only for
      <tag class='element'>color</tag>s that are used as background colors
      of widgets. A background color gradient is a color that
      that transitions across its widget.
    </para>

    <para>
      &appshort;'s gradient colors are directly implemented using the
      &render;'s
      <quote>CreateLinearGradient</quote>
      and <quote>CreateRadialGradient</quote> requests. &appshort; forms
      the &RENDER; request by translating and computing its values
      from a virtualized representation; from virtual
      coordinates. The following is a brief summary of the
      <acronym>XML</acronym> format that forms each request, and a brief
      description, see the &RENDER; specification for more information.
    </para>

    <blockquote>
      <informalexample>
	<programlisting><![CDATA[
<color id="bgcolor" type="linear_gradient">
  <x1>0</x1>
  <y1>0</y1>
  <x2>0</x2>
  <y2>1</y2>

  <gradient>
    <value>0</value>
    <color>gray</color>
  </gradient>
  <gradient>
    <value>1</value>
    <color>silver</color>
  </gradient>
  <gradient>
    <value>2</value>
    <color>white</color>
  </gradient>
</color>

<!-- ... -->

<layout type="grid" id="main-window-grid">

  <background_color>
    <color>bgcolor</color>
  </background_color>

  <!-- ... -->
</layout>]]></programlisting>
      </informalexample>
    </blockquote>

    <para>
      Gradient
      <tag class='element'>color</tag>s contain two or more
      <tag class='element'>gradient</tag>s.
      <tag class='element'>value</tag>s are non-negative integers, one
      of the <tag class='element'>value</tag>s must be 0, and all
      <tag class='element'>value</tag>s must be unique.
      The highest value sets the gradient's range, and each
      <tag class='element'>gradient</tag> specifies a
      <tag class='element'>color</tag> that references another plain
      <tag class='element'>color</tag>.
    </para>

    <para>
      A
      <quote><literal>linear_gradient</literal></quote>
      <tag class='attribute'>type</tag> defines a gradient with a linear
      color
      transition to each
      <tag class='element'>color</tag> across a range of 0
      to the maximum <tag class='element'>value</tag>.
      This is the same as setting
      <ulink url="&link-typedef-x--w-color-arg;"><classname>&ns;::w::color_arg</classname></ulink>
      from an
      <ulink url="&link-x--w--linear-gradient;"><classname>&ns;::w::linear_gradient</classname></ulink>.
      The above example creates a gradient that starts
      with the
      <quote><literal>gray</literal></quote> color,
      becomes a
      <quote><literal>silver</literal></quote> color at exactly the midpoint,
      and reaches the
      <quote><literal>white</literal></quote> color at the end.

      Using  <tag class='element'>value</tag>s of 0, 3, 4 results in a
      linear gradient that transitions to the 3 color at about 75% of the
      way from the starting to the ending color value.
    </para>

    <para>
      The gradient colors transition over virtual coordinates of
      <quote><literal>(x1, y1)</literal></quote> through
      <quote><literal>(x2, y2)</literal></quote>. The coordinate
      <quote><literal>(0, 0)</literal></quote> is the upper-left corner of
      the widget.
      <quote><literal>(1, 1)</literal></quote> is the bottom-right corner.
      Specifying <tag class='element'>x1</tag>,
      <tag class='element'>y1</tag>,
      <tag class='element'>x2</tag>, and
      <tag class='element'>y2</tag> is optional; and they default to
      <quote><literal>(0, 0)</literal></quote> and
      <quote><literal>(1, 1)</literal></quote>; by default, a linear
      gradient transition from the upper-left corner to the bottom-right
      corner.
    </para>

    <blockquote>
      <informalexample>
	<programlisting><![CDATA[
<color id="bgcolor" type="linear_gradient">
  <widthmm>10</widthmm>
  <heightmm>10</heightmm>

  <!-- .... -->

</color>]]></programlisting>
      </informalexample>
    </blockquote>

    <para>
      The virtual gradient range of
      <quote><literal>(0, 0)</literal></quote> to
      <quote><literal>(1, 1)</literal></quote> gets automatically scaled
      to the widget's size, so that
      <quote><literal>(0, 0)</literal></quote> is always the top-left
      corner, and
      <quote><literal>(1, 1)</literal></quote> is always the widget's bottom-right corner.
      Specifying
      <tag class='element'>widthmm</tag>,
      <tag class='element'>heightmm</tag> sets a fixed width or height,
      specified in millimeters,
      that gets used to compute the virtual gradient positions, instead
      of automatically adjusting them to the widget's actual size.
      This example creates a gradient for a size of 10x10 millimeters;
      <quote><literal>(0, 0)</literal></quote> is still the top-left
      corner and <quote><literal>(1, 1)</literal></quote> is 10 millimeters
      below and to the right of it.
      If the widget is larger, the additional space gets filled
      with the closest color from the computed gradient; a smaller widget results in a clipped gradient.
    </para>

    <para>
      A negative <tag class='element'>widthmm</tag> or
      <tag class='element'>heightmm</tag> value anchors the gradient
      coordinates to the opposite border.
      A
      <tag class='element'>widthmm</tag> and
      <tag class='element'>heightmm</tag> of
      <quote><literal>-10</literal></quote> results in a 10x10 millimeter
      gradient that's anchored at the widget's bottom-right
      corner.
    </para>
    <blockquote>
      <informalexample>
	<programlisting><![CDATA[
<color  id="bgcolor" type="radial_gradient">
  <inner_x>.5</inner_x>
  <inner_y>.5</inner_y>
  <outer_x>.5</outer_x>
  <outer_y>.5</outer_y>
  <inner_radius>0</inner_radius>
  <outer_radius>.5</outer_radius>
  <inner_radius_axis>shortest</inner_radius_axis>
  <outer_radius_axis>longest</outer_radius_axis>

  <gradient>
    <value>0</value>
    <color>gray</color>
  </gradient>
  <gradient>
    <value>1</value>
    <color>white</color>
  </gradient>
</color>]]></programlisting>
      </informalexample>
    </blockquote>

    <para>
      A
      <quote><literal>radial_gradient</literal></quote>
      <tag class='attribute'>type</tag> also defines a gradient from
      a <tag class='element'>value</tag>s of 0 to the maximum
      <tag class='element'>value</tag>.
      The radial gradiant also gets defined in a virtual coordinate range
      <quote><literal>(0, 0)</literal></quote> to
      <quote><literal>(1, 1)</literal></quote>, and also based
      on two coordinates in the range, which are specified as
      <quote><literal>(inner_x, inner_y)</literal></quote> and
      <quote><literal>(outer_x, outer_y)</literal></quote>.
    </para>

    <para>
      <tag class='element'>inner_radius</tag> defines a circle whose
      center is
      <quote><literal>(inner_x, inner_y)</literal></quote> and
      <tag class='element'>outer_radius</tag> defines a circle whose
      center is
      <quote><literal>(outer_x, outer_y)</literal></quote>.
      The actual radius value of 1 is defined by
      <tag class='element'>inner_radius_axis</tag> and
      <tag class='element'>outer_radius_axis</tag>, respectively.
      This is the same as setting
      <ulink url="&link-typedef-x--w-color-arg;"><classname>&ns;::w::color_arg</classname></ulink>
      from an
      <ulink url="&link-x--w--radial-gradient;"><classname>&ns;::w::radial_gradient</classname></ulink>.
    </para>

    <para>
      The above example shows the default values for all these settings,
      if not specified.
    </para>

    <para>
      The inner circle must be contained entirely within the outer circle.
      The
      <tag class='element'>color</tag> value of 0 forms the area inside
      the inner circle, and the color gradient transition accordingly,
      to the maximum
      <tag class='element'>color</tag> value that forms the area outside the
      outer circle.
    </para>

    <para>
      Optional
      <tag class='element'>widthmm</tag> and
      <tag class='element'>heightmm</tag> values work the same way for radial
      gradient as they do for linear gradients.
    </para>
  </section>

  <section id="uixmlvalues">
    <title>Other values in theme files</title>

    <para>
      Values for various properties of &supportedthemewidget;s and
      <link linkend="uixmlappearance">appearance object</link>s directly
      translate to the values of various &appshort; data types.
    </para>

    <section id="uixmlhalignvalue">
      <title><ulink url="&link-enum-x--w-halign;"><classname>&ns;::w::halign</classname></ulink> values</title>
      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<halign>left</halign>]]></programlisting>
	</informalexample>
      </blockquote>

      <para>
	An <classname>&ns;::w::halign</classname> value
	is one of:
	<quote><literal>left</literal></quote>,
	<quote><literal>center</literal></quote>,
	<quote><literal>right</literal></quote>, or
	<quote><literal>fill</literal></quote>.
      </para>
    </section>

    <section id="uixmlvalignvalue">
      <title><ulink url="&link-enum-x--w-valign;"><classname>&ns;::w::valign</classname></ulink> values</title>
      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<valign>middle</valign>]]></programlisting>
	</informalexample>
      </blockquote>

      <para>
	An <classname>&ns;::w::valign</classname> value
	is one of:
	<quote><literal>top</literal></quote>,
	<quote><literal>middle</literal></quote>,
	<quote><literal>bottom</literal></quote>, or
	<quote><literal>fill</literal></quote>.
      </para>
    </section>

    <section id="uixmlscrollbar_visibilityvalue">
      <title><ulink url="&link-enum-x--w-scrollbar-visibility;"><classname>&ns;::w::scrollbar_visibility</classname></ulink> values</title>
      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<horizontal_visibility>automatic</horizontal_visibility>]]></programlisting>
	</informalexample>
      </blockquote>

      <para>
	An <classname>&ns;::w::scrollbar_visibility</classname> value
	is one of:
	<quote>never</quote>,
	<quote>always</quote>,
	<quote>automatic</quote>,
	or
	<quote>automatic_reserved</quote>.
      </para>
    </section>

    <section id="uixmltext_paramvalue">
      <title><ulink url="&link-x--w--text-param;"><classname>&ns;::w::text_param</classname></ulink> values</title>
      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<label type='theme_text'>${context:file-dialog}Directory:</name>]]></programlisting>
	</informalexample>
      </blockquote>

      <para>
	The content of elements that specify values of
	<classname>&ns;::w::text_param</classname> fields is
	<ulink url="&link-x--w--theme-text;"><classname>&ns;::w::theme_text</classname></ulink>-formatted
	text
	with references to colors and fonts defined in the theme file or the
	default display theme.
      </para>

      <section id="uixmlgettext">
	<title>Using gettext with
	  <classname>&ns;::w::text_param</classname> values</title>

	<para>
	  If the generator object has an optionally attached message catalog,
	  each text label in the theme file gets looked up in the message
	  catalog.
	  The <tag class="attribute">type</tag> attribute gets ignored when
	  creating widget from the theme file, and it serves to mark
	  translatable text in the theme file, such as the one in the
	  <tag class='element'>label</tag> element.
	  <application>gettext</application> tools know look only for
	  translatable strings in C/C++ source, so &appshort; provides
	  an <acronym>XML</acronym> stylesheet that creates a pseudo-C/C++
	  file that does not get compiled, but it contains translatable
	  strings that <application>gettext</application>'s
	  <command>msgfmt</command> picks up and adds to the message catalog
	  template.
	</para>

	<para>
	  The <filename>extract-theme-text.xsl</filename> file in
	  &appshort;'s <filename>theme</filename> directory is a stylesheet
	  that generates pseudo C/C++ source containing text from any
	  element with a
	  <literal><tag class="attribute">type</tag>="theme_text"</literal>
	  in a theme file:
	</para>

	<blockquote>
	  <informalexample>
	    <programlisting>
xsltproc <replaceable>...</replaceable>/extract-theme-text.xsl theme.xml &gt;strings.C</programlisting>
	  </informalexample>
	</blockquote>

	<para>
	  If <filename>theme.xml</filename>'s contents include the above
	  example, the resulting
	  <filename>strings.C</filename> has the following contents:
	</para>

	<blockquote>
	  <informalexample>
	    <programlisting>
_("${context:file-dialog}Directory:")</programlisting>
	  </informalexample>
	</blockquote>

	<para>
	  This gets picked up by <command>msgfmt</command> and included with
	  the rest of the application's translatable strings. &appshort;
	  provides <command>automake</command> macros to automate this process.
	  In the <filename>Makefile.am</filename>:
	</para>

	<blockquote>
	  <informalexample>
	    <programlisting>
$(call EXTRACT_THEME_TEXT_GEN,strings.C,theme.xml)</programlisting>
	  </informalexample>
	</blockquote>

	<para>
	  This creates <filename>Makefile</filename> rules that automatically
	  build <filename>strings.C</filename> from
	  <filename>theme.xml</filename>.
	  The <literal>EXTRACT_THEME_TEXT_GEN</literal> macro comes from
	  <link linkend="developing">&appshort;'s
	    <literal>@LIBCXXW_AM@</literal> framework</link>.
	</para>

	<blockquote>
	  <informalexample>
	    <programlisting>
#include &lt;&ns;/locale.H&gt;
#include &lt;&ns;/messages.H&gt;

// ...
auto utf8_locale=&ns;::locale::base::utf8();

auto catalog=&ns;::messages::create("app", utf8_locale);

auto generators=&ns;::w::const_uigenerators::create("uigenerator4.xml", catalog);</programlisting>
	  </informalexample>
	</blockquote>

	<para>
	  Specifying the optional
	  <ulink url="&link-typedef-x-messages;"><classname>&ns;::messages</classname></ulink>
	  parameter,
	  when <link linkend="uixmlgenerate">creating a generator</link> object,
	  attaches a message catalog to the generator
	  generator.
	  The message catalog should explicitly use a UTF-8
	  <ulink url="&link-typedef-x-locale;"><classname>&ns;::locale</classname></ulink>
	  so that the translated messages get directly converted to Unicode.
	</para>
      </section>
    </section>

    <section id="uixmlshortcutvalue">
      <title><ulink url="&link-x--w--shortcut;"><classname>&ns;::w::shortcut</classname></ulink> values</title>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<shortcut type='theme_text'>${context:settings-dialog}Alt-G</shortcut></programlisting>]]>
          </programlisting>
        </informalexample>
      </blockquote>

      <para>
	An <ulink url="&link-x--w--shortcut;"><classname>&ns;::w::shortcut</classname></ulink>
	contains text that uses the same
	<ulink url="&link-x--w--theme-text;"><classname>&ns;::w::theme_text</classname></ulink>
	formatting as &text_paramvalue;s, except
	fonts, colors, and other visual markup references are not allowed,
	of course.
	Keyboard shortcuts frequently associate with buttons and labels that
	have <link linkend="uixmlgettext">translatable text</link>;
	with distinct <literal>${context}</literal>s that discriminate
	different text. This allows the associated keyboard shortcuts also
	have translated text; and if the main button or label's text gets
	translated, the associated keyboard shortcut gets revised accordingly.
      </para>

      <note>
	<para>
	  This means that a shortcut must use <quote>$$</quote> to refer
	  to the <literal>$</literal> key.
	</para>
      </note>

      <para>
	The specified shortcut text selects the most appropriate
	<ulink url="&link-x--w--shortcut;"><classname>&ns;::w::shortcut</classname></ulink>
	constructor: a single character, or
	one or more modifiers, like
	<quote>Ctrl</quote> or <quote>Alt</quote>,
	followed by a single character, or <quote>Fn</quote>
	(function key), or a recognized special key (like
	<quote>Left</quote> or <quote>Del</quote>).
      </para>
    </section>
  </section>

  <section id="uixmllayoutgrid">
    <title>
      <tag class='attribute'>type</tag>=<quote>grid</quote>
      <tag class='element'>layout</tag>s
    </title>

    <blockquote>
      <informalexample>
	<programlisting><![CDATA[
<dim id="extra-padding">2.0</dim>

<layout type="grid" id="main-window-grid">

  <halign>
    <col>0</col>
    <halign>left</halign>
  </halign>

  <valign>
    <row>0</row>
    <valign>middle</valign>
  </valign>

  <padding>
    <row>0</row>
    <side>left</side>
    <padding>extra-padding</padding>
  </padding>
</layout>]]>

&ns;::w::gridlayoutmanager glm=container->get_layoutmanager();

glm->generate("main-window-grid", generator, elements);</programlisting>
      </informalexample>
    </blockquote>

    <para>
      The contents of a
      <tag class='element'>layout</tag>s of
      <tag class='attribute'>type</tag>=<quote>grid</quote>
      specify the methods invoked by <link linkend="gridlayoutmanager">grid
	layout manager</link>'s <methodname>generate</methodname>().
    </para>

    <section id="uixmllayoutgridbackgroundcolor">
      <title><tag class='element'>background_color</tag></title>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<layout type="grid" id="main-window-grid">

<!-- ... -->

  <background_color>
    <color>bgcolor</color>
  </background>

<!-- ... -->

</layout>]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	<tag class='element'>background_color</tag>
	invokes the grid layout manager's
	<methodname>set_background_color</methodname>() method.
      </para>
    </section>

    <section id="uixmllayoutgridremovebackgroundcolor">
      <title><tag class='element'>remove_background_color</tag></title>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<layout type="grid" id="main-window-grid">

<!-- ... -->

  <remove_background_color />

<!-- ... -->

</layout>]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	<tag class='element'>remove_background_color</tag>
	invokes the grid layout manager's
	<methodname>remove_background_color</methodname>() method.
      </para>
    </section>

    <section id="uixmllayoutgridhalign">
      <title><tag class='element'>halign</tag></title>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<layout type="grid" id="main-window-grid">

<!-- ... -->

  <halign>
    <col>0</col>
    <halign>centered</halign>
  </halign>

<!-- ... -->

</layout>]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	<tag class='element'>halign</tag>
	invokes the grid layout manager's
	<methodname>col_alignment</methodname>() method.
	The
	<tag class='element'>halign</tag> element contains an
	&halignvalue;.
      </para>
    </section>

    <section id="uixmllayoutgridvalign">
      <title><tag class='element'>valign</tag></title>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<layout type="grid" id="main-window-grid">

<!-- ... -->

  <valign>
    <row>0</row>
    <valign>bottom</valign>
  </valign>

<!-- ... -->

</layout>]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	<tag class='element'>valign</tag>
	invokes the grid layout manager's
	<methodname>row_alignment</methodname>() method.
	The
	<tag class='element'>valign</tag> element contains an &valignvalue;.
      </para>
    </section>


    <section id="uixmllayoutgridpadding">
      <title><tag class='element'>padding</tag></title>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<dim id="cell-padding">4.0</dim>

<layout type="grid" id="main-window-grid">

<!-- ... -->

  <padding>
    <side>top</side>
    <row>0</row>
    <padding>cell-padding</padding>
  </padding>

  <padding>
    <side>bottom</side>
    <row>0</row>
    <padding>cell-padding</padding>
  </padding>

  <padding>
    <side>left</side>
    <col>0</col>
    <padding>cell-padding</padding>
  </padding>

  <padding>
    <side>right</side>
    <col>0</col>
    <padding>cell-padding</padding>
  </padding>

<!-- ... -->

</layout>]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	<tag class='element'>padding</tag>
	invokes the grid layout manager's
	<methodname>row_top_padding</methodname>(),
	<methodname>row_bottom_padding</methodname>(),
	<methodname>col_left_padding</methodname>(), or
	<methodname>col_right_padding</methodname>() method.
      </para>
    </section>

    <section id="uixmllayoutgridborder">
      <title><tag class='element'>default_col_border</tag>
      and <tag class='element'>default_row_border</tag></title>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[

<border id="thick">

<!-- .. -->

</border>

<layout type="grid" id="main-window-grid">

<!-- ... -->

   <default_col_border>
      <col>1</col>
      <border>thick</border>
   </default_col_border>

   <default_row_border>
      <row>1</row>
      <border>thick</border>
   </default_row_border>

<!-- ... -->

</layout>]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	These elements
	invoke the grid layout manager's
	<methodname>default_col_border()</methodname>() or
	<methodname>default_row_border()</methodname>() method.
      </para>
    </section>

    <section id="uixmllayoutgridpercent">
      <title><tag class='element'>percent</tag></title>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<layout type="grid" id="main-window-grid">

<!-- ... -->

   <percent>
     <col>0</col>
     <percentage>50</percentage>
   </percent>

   <percent>
     <row>0</row>
     <percentage>50</percentage>
   </percent>

<!-- ... -->

</layout>]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	<tag class='element'>percent</tag>
	invokes the grid layout manager's
	<methodname>requested_col_width</methodname>() or
	<methodname>requested_row_height</methodname>() method.
      </para>
    </section>

    <section id="uixmllayoutgridremovedefaults">
      <title><tag class='element'>remove_col_defaults</tag> and
	<tag class='element'>remove_row_defaults</tag></title>
      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<layout type="grid" id="main-window-grid">

<!-- ... -->

   <remove_col_defaults>
     <col>0</col>
   </remove_col_defaults>

   <remove_row_defaults>
     <row>0</row>
   </remove_row_defaults>


<!-- ... -->

</layout>]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	These elements
	invoke the grid layout manager's
	<methodname>remove_col_defaults</methodname>() and
	<methodname>remove_row_defaults</methodname>() methods.
      </para>
    </section>

    <section id="uixmllayoutgridremove">
      <title><tag class='element'>remove_all</tag>,
	<tag class='element'>remove_row</tag>, and
	<tag class='element'>remove_cell</tag></title>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<layout type="grid" id="main-window-grid">

<!-- ... -->

   <remove_all />

   <remove_row>
     <row>0</row>
   </remove_row>

   <remove_cell>
     <row>0</row>
     <col>0</col>
   </remove_cell>
<!-- ... -->

</layout>]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	These elements
	invoke the grid layout manager overloaded methods that remove
	all existing contents, a single row, or a single cell.
      </para>
    </section>

    <section id="uixmllayoutgridcreaterows">
      <title><tag class='element'>append_row</tag>,
	<tag class='element'>insert_row</tag>,
	<tag class='element'>append_columns</tag>,
	<tag class='element'>insert_columns</tag>,
	<tag class='element'>replace_row</tag>, and
	<tag class='element'>replace_cell</tag></title>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<layout type="grid" id="main-window-grid">

<!-- ... -->

  <append_row>
    <name>statusbar</name>
  </append_row>

  <insert_row>
    <row>1</row>
    <name>statusbar</name>
  </insert_row>

  <append_columns>
    <row>1</row>
    <name>statusbar</name>
  </append_columns>

  <insert_columns>
    <row>1</row>
    <col>0</col>
    <name>statusbar</name>
  </insert_columns>

  <replace_row>
    <row>1</row>
    <name>statusbar</name>
  </replace_row>

  <replace_cell>
    <row>1</row>
    <col>1</col>
    <name>statusbar</name>
  </replace_cell>

<!-- ... -->

</layout>

<!-- ... -->

<factory type="grid" id="statusbar">

<!-- ... -->

</factory>

]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
      	These methods create a new grid factory using the corresponding
	grid layout manager method; then use the referenced
	<tag class='attribute'>type</tag>=<quote><literal>grid</literal></quote>
	<tag class='element'>factory</tag> widget to create new elements
	in the grid layout manager's container using the new grid factory.
      </para>
    </section>
  </section>

  <section id="uixmlfactorygrid">
    <title>
      <tag class='attribute'>type</tag>=<quote>grid</quote>
      <tag class='element'>factory</tag>s
    </title>

    <blockquote>
      <informalexample>
	<programlisting><![CDATA[
<factory type="grid" id="statusrow">

  <padding>
    <side>all</side>
    <padding>2</padding>
  </padding>

  <element>
    <name>label</name>
  </element>

</factory>]]></programlisting>
      </informalexample>
    </blockquote>

    <para>
      The contents of a
      <tag class='element'>factory</tag>s of
      <tag class='attribute'>type</tag>=<quote>grid</quote>
      specify the methods invoked on a
      <ulink url="&link-typedef-x--w-gridfactory;">grid
	    factory</ulink>.
    </para>

    <section id="uixmlfactorygridhalign">
      <title><tag class='element'>halign</tag></title>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<factory type="grid" id="statusrow">

<!-- ... -->

    <halign>
       <halign>right</halign>
    </halign>

<!-- ... -->

</factory>]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	<tag class='element'>halign</tag>
	invokes the grid factory's
	<methodname>halign</methodname>()
	method.
	The
	<tag class='element'>halign</tag> element contains an &halignvalue;.
      </para>
    </section>

    <section id="uixmlfactorygridvalign">
      <title><tag class='element'>valign</tag></title>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<factory type="grid" id="statusrow">

<!-- ... -->

    <valign>
       <valign>middle</valign>
    </valign>

<!-- ... -->

</factory>]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	The
	<tag class='element'>valign</tag>
	invokes the grid factory's
	<methodname>valign</methodname>()
	method.
	The
	<tag class='element'>valign</tag> element contains an &valignvalue;.
      </para>
    </section>

    <section id="uixmlfactorygridpadding">
      <title><tag class='element'>padding</tag></title>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<factory type="grid" id="statusrow">

<!-- ... -->

  <padding>
    <side>all</side>
    <padding>cell-padding</padding>
  </padding>

<!-- ... -->

</factory>]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	<tag class='element'>padding</tag>
	invokes the grid factory's
	<methodname>padding</methodname>(),
	<methodname>left_padding</methodname>(),
	<methodname>right_padding</methodname>(),
	<methodname>top_padding</methodname>(), or
	<methodname>bottom_padding</methodname>() method.
	The <tag class='element'>side</tag> value is one of
	<quote><literal>all</literal></quote>,
	<quote><literal>left</literal></quote>,
	<quote><literal>right</literal></quote>,
	<quote><literal>top</literal></quote>, or
	<quote><literal>bottom</literal></quote>.
     </para>
    </section>

    <section id="uixmlfactorygridborder">
      <title><tag class='element'>border</tag></title>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<factory type="grid" id="statusrow">

<!-- ... -->

  <border>
    <side>all</side>
    <border>thick-border</border>
  </padding>


<!-- ... -->

</factory>]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	<tag class='element'>border</tag>
	invokes the grid factory's
	<methodname>border</methodname>(),
	<methodname>left_border</methodname>(),
	<methodname>right_border</methodname>(),
	<methodname>top_border</methodname>(), or
	<methodname>bottom_border</methodname>() method.
	The <tag class='element'>side</tag> value is one of
	<quote><literal>all</literal></quote>,
	<quote><literal>left</literal></quote>,
	<quote><literal>right</literal></quote>,
	<quote><literal>top</literal></quote>, or
	<quote><literal>bottom</literal></quote>.
      </para>
    </section>

    <section id="uixmlfactorygridspan">
      <title><tag class='element'>colspan</tag> and
	<tag class='element'>rowspan</tag></title>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<factory type="grid" id="statusrow">

<!-- ... -->

   <colspan>
     <columns>2</columns>
   </colspan>

   <rowspan>
     <rows>2</rows>
   </rowspan>

<!-- ... -->

</factory>]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	<tag class='element'>colspan</tag>
	and
	<tag class='element'>rowspan</tag>
	invoke the grid factory's
	<methodname>colspan</methodname>() and
	<methodname>rowspan</methodname>() methods, respectively.
      </para>
    </section>

    <section id="uixmlfactorygridremovewhenhidden">
      <title><tag class='element'>remove_when_hidden</tag></title>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<factory type="grid" id="statusrow">

<!-- ... -->

  <remove_when_hidden />

<!-- ... -->

</factory>]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	<tag class='element'>remove_when_hidden</tag>
	invokes the grid factory's
	<methodname>remove_when_hidden</methodname>()
	method.
      </para>
    </section>

    <section id="uixmlfactorygridelement">
      <title><tag class='element'>element</tag>s and
	<tag class='element'>container</tag>s</title>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<factory type="grid" id="statusrow">

<!-- ... -->

  <element>
    <name>label</name>
  </element>

<!-- ... -->

  <container>
    <type>grid</type>
    <name>bottom-container</name>
  </container>

<!-- ... -->

</factory>]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	<tag class='element'>element</tag>s and
	<tag class='element'>container</tag>s
	use the factory to create a new
	&themewidgetorcontainer;.
      </para>
    </section>
  </section>

  <section id="uixmllayoutbook">
    <title>
      <tag class='attribute'>type</tag>=<quote>book</quote>
      <tag class='element'>layout</tag>s
    </title>

    <blockquote>
      <informalexample>
	<programlisting><![CDATA[
<layout type="book" id="application-settings">

<!-- ... -->

</layout>]]>

&ns;::w::booklayoutmanager glm=container->get_layoutmanager();

glm->generate("application-settings", generator, elements);</programlisting>
      </informalexample>
    </blockquote>

    <para>
      The contents of a
      <tag class='element'>layout</tag>s of
      <tag class='attribute'>type</tag>=<quote>book</quote>
      specify the methods invoked by <link linkend="booklayoutmanager">book
	layout manager</link>'s <methodname>generate</methodname>().
    </para>


    <section id="uixmllayoutbookappendinsertpages">
      <title><tag class='element'>append_pages</tag>
      and <tag class='element'>insert_pages</tag></title>
      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<layout type="book" id="application-settings">

<!-- ... -->

    <append_pages>
      <name>general-settings</name>
    </append_pages>

    <append_pages>
      <name>process-settings</name>
      <pos>0</pos>
    </append_pages>


<!-- ... -->

</layout>

<factory type="book" id="general-settings">

<!-- ... -->

</factory>

<factory type="book" id="process-settings">

<!-- ... -->

</factory>

]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	<tag class='element'>append_pages</tag> and
	<tag class='element'>insert_pages</tag>
	invoke the book layout manager's
	<methodname>append</methodname>() and
	<methodname>insert</methodname>() methods to create a new
	<link linkend="bookpagefactory"><classname>&ns;::w::bookpagefactory</classname></link>,
	then use the
	<tag class='element'>name</tag>d
	<tag class='attribute'>type</tag>=<quote><literal>book</literal></quote>
	<tag class='element'>factory</tag> widget to create new book
	pages.
      </para>
    </section>

    <section id="uixmllayoutbookremove">
      <title><tag class='element'>remove</tag></title>
      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<layout type="book" id="application-settings">

<!-- ... -->

  <open>
    <page>0</page>
  </open>

<!-- ... -->

</layout>]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	<tag class='element'>remove</tag>
	invokes the book layout manager's
	<methodname>remove</methodname>() method.
      </para>
    </section>

    <section id="uixmllayoutbookopen">
      <title><tag class='element'>open</tag></title>
      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<layout type="book" id="application-settings">

<!-- ... -->

  <open>
    <page>0</page>
  </open>

<!-- ... -->

</layout>]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	<tag class='element'>open</tag>
	invokes the book layout manager's
	<methodname>open</methodname>() method.
      </para>
    </section>

    <section id="uixmllayoutbookclose">
      <title><tag class='element'>close</tag></title>
      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<layout type="book" id="application-settings">

<!-- ... -->

   <close />

<!-- ... -->

</layout>]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	<tag class='element'>close</tag>
	invokes the book layout manager's
	<methodname>close</methodname>() method.
      </para>
    </section>
  </section>

  <section id="uixmlfactorybook">
    <title>
      <tag class='attribute'>type</tag>=<quote>book</quote>
      <tag class='element'>factory</tag>s
    </title>

    <blockquote>
      <informalexample>
	<programlisting><![CDATA[
<factory type="book" id="settings">

    <add>
      <label>general-label</label>
      <layout>options</layout>
    </add>

</factory>]]></programlisting>
      </informalexample>
    </blockquote>

    <para>
      The contents of a
      <tag class='element'>factory</tag>s of
      <tag class='attribute'>type</tag>=<quote>book</quote>
      specify the methods invoked on a
      <link linkend="bookpagefactory">book page factory</link>.
    </para>

    <section id="uixmlfactorybookhalign">
      <title><tag class='element'>halign</tag></title>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<factory type="book" id="settings">

<!-- ... -->

    <halign>
       <halign>right</halign>
    </halign>

<!-- ... -->

</factory>]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	<tag class='element'>halign</tag>
	invokes the book page factory's
	<methodname>halign</methodname>()
	method.
	The
	<tag class='element'>halign</tag> element contains an &halignvalue;.
      </para>
    </section>

    <section id="uixmlfactorybookvalign">
      <title><tag class='element'>valign</tag></title>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<factory type="book" id="settings">

<!-- ... -->

    <valign>
       <valign>middle</valign>
    </valign>

<!-- ... -->

</factory>]]></programlisting>
	</informalexample>
      </blockquote>
      <para>
	<tag class='element'>valign</tag>
	invokes the book page factory's
	<methodname>valign</methodname>()
	method.
	The
	<tag class='element'>valign</tag> element contains an &valignvalue;.
      </para>
    </section>

    <section id="uixmlfactorybooksetappearance">
      <title><tag class='element'>set_appearance</tag></title>
      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<factory type="book" id="settings">

<!-- ... -->

  <set_appearance>
    <appearance>booksettings</appearance>
  </set_appearance>
</factory>

<!-- ... -->

<appearance id="booksettings" type="bookpage" from="theme">
</appearance>]]></programlisting>
	</informalexample>
      </blockquote>

      <para>
	<tag class='element'>set_appearance</tag>
	invokes the book page factory's
	<methodname>set_appearance</methodname>()
	method.
	The
	<tag class='element'>appearance</tag> value gives the
	<tag class='attribute'>id</tag> of a
	<tag class='attribute'>type</tag>=<quote>bookpage</quote>
	<link linkend="uixmlappearance">appearance object</link>.
      </para>
    </section>

    <section id="uixmlfactorybookcontainer">
      <title><tag class='element'>add</tag></title>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<factory type="book" id="settings">

<!-- ... -->

  <add>
    <tab>
      <element>
        <label type='theme_text'>${context:settings-dialog}${decoration:underline}G${decoration:none}eneral settings</label>
      </element>
    </tab>
    <shortcut type='theme_text'>${context:settings-dialog}Alt-G</shortcut>
    <page>
      <container>
        <type>grid</type>
        <name>general-settings</name>
      </container>
    </page>
  </add>

<layout type="grid" id="general-settings">

</layout>]]></programlisting>
	</informalexample>
      </blockquote>

      <para>
	<tag class='element'>add</tag>
	invokes the book page factory's
	<methodname>add</methodname>()
	method, creating a new tab and a page in the book container.
      </para>

      <para>
	The <tag class='element'>tab</tag> element creates the page's
	tab, and must have exactly one &themewidgetorcontainer;. It's
	usually a
	<link linkend="uixmlfactorylabelelement">plain label</link>.
      </para>

      <para>
	The <tag class='element'>page</tag> element creates the page itself,
	and must have exactly one &themewidgetorcontainer;. It is usually
	a &themecontainer;.
      </para>

      <para>
	An optional <tag class='element'>shortcut</tag>
	element contains the page's &keyboard_shortcutvalue;.
      </para>
    </section>
  </section>

  <section id="uixmlfactoryelement">
    <title><tag class='element'>element</tag> and
      <tag class='element'>container</tag> widgets</title>

    <blockquote>
      <informalexample>
	<programlisting><![CDATA[
<factory type="grid" id="statusrow">

<!-- ... -->

  <element>
    <name>label</name>
  </element>

<!-- ... -->

</factory>]]>


&ns;::w::uielements element_factory{
  {
    {"label",
     []
     (const &ns;::w::factory &amp;factory)
     {
         factory-&gt;create_label("Label");
     }
    }
  }
};</programlisting>
      </informalexample>
    </blockquote>

    <para>
      An <tag class='element'>element</tag> with a
      <tag class='element'>name</tag>
      (a <quote>named element</quote>)
      invokes the named callback from the
      <ulink url="&link-x--w--uielements;"><classname>&ns;::w::uielements</classname></ulink>
      parameter to
      <link linkend="uixmlgenerate"><methodname>generate</methodname>()</link>.

      This callback receives an
      <ulink url="&link-typedef-x--w-factory;"><classname>&ns;::w::factory</classname></ulink>
      parameter which gets used, presumably, to create a widget.
      The first member of the
      <classname>&ns;::w::uielements</classname>
      object is map. The map's key is a <classname>std::string</classname>,
      and the
      <tag class='element'>name</tag>
      value gives the callback's key value. An exception gets thrown
      if the <tag class='element'>name</tag>
      key does not exist.
    </para>

    <para>
      It's possible that the same
      <tag class='element'>name</tag> value appears more than once, in the
      same or different
      <tag class='element'>factory</tag>s. Each occurence of a
      <tag class='element'>name</tag> results in the callback getting
      invoked.
    </para>

    <blockquote>
      <informalexample>
	<programlisting><![CDATA[
<element id="fixed-canvas" tooltip="canvas-tooltip">

    ...

</element>

<container>
    <type>grid</type>
    <name>bottom-container</name>
</container>

<!-- ... -->

<layout type="grid" id="bottom-container">

<!-- ... -->

</layout>



]]>

/* ----- */
&ns;::w::uielements elements;

layout_manager->generate("dialog", generators, elements);

&ns;::w::canvas fixed_canvas=elements.get_element("fixed-canvas");

&ns;::w::container bottom_container=elements.get_element("bottom-container");</programlisting>
      </informalexample>
    </blockquote>

    <para>
      An <tag class='element'>element</tag> without a
      <tag class='element'>name</tag> creates one of several supported widgets
      directly, without invoking an application callback, using the
      given parameters. Supported widgets:
    </para>

    <itemizedlist>
      <listitem>
	<para>
	  <link linkend="uixmlfactorylabelelement"><classname>&ns;::w::label</classname></link>s
	</para>
      </listitem>
      <listitem>
	<para>
	  <link linkend="uixmlfactorycanvaselement"><classname>&ns;::w::canvas</classname></link>es
	</para>
      </listitem>
      <listitem>
	<para>
	  <link linkend="uixmlfactoryfocusablelabelelement"><classname>&ns;::w::focusable_label</classname></link>s
	</para>
      </listitem>
      <listitem>
	<para>
	  <link linkend="uixmlfactorybuttonelement"><classname>&ns;::w::button</classname></link>s
	</para>
      </listitem>
      <listitem>
	<para>
	  <link linkend="uixmlfactoryinputfieldelement"><classname>&ns;::w::input_field</classname></link>s
	</para>
      </listitem>
      <listitem>
	<para>
	  <link linkend="uixmlfactorydateinputfieldelement"><classname>&ns;::w::date_input_field</classname></link>s
	</para>
      </listitem>
      <listitem>
	<para>
	  <link linkend="uixmlfactorycheckboxelement">checkbox</link>
	  <classname>&ns;::w::image_button</classname>s
	</para>
      </listitem>
    </itemizedlist>

    <para>
      These <tag class="element">element</tag> widgets have an optional
      <tag class="attribute">id</tag> attribute.
      After the widgets get generated,
      <link linkend="uixmlgenerate"><classname>&ns;::w::uielements</classname></link>'s
      <methodname>get_element</methodname>() retrieves the created widget
      with the specified <tag class="attribute">id</tag>.
      Duplicate <tag class="attribute">id</tag>s get ignored;
      <methodname>get_element</methodname>() returns the first widget with
      the specified <tag class="attribute">id</tag>.
    </para>

    <para>
      These <tag class="element">element</tag> widgets also have an optional
      <tag class="attribute">tooltip</tag> attribute that
      <link linkend="uixmlelementtooltip">creates a tooltip for the
	widget</link>.
    </para>

    <para>
      A <tag class="element">container</tag> creates a new &container;
      widget. Its <tag class="element">name</tag> serves a dual purpose:
    </para>

    <itemizedlist>
      <listitem>
	<para>
	  It gives the <tag class="element">layout</tag> with the same
	  <tag class="attribute">id</tag> as the
	  <tag class="element">container</tag>'s
	  <tag class="element">name</tag>.
	  The
	  <tag class="element">type</tag>s must match.
	  This specifies the new &container;'s layout and creates the
	  widget in the &container;.
	</para>
      </listitem>

      <listitem>
	<para>
	  After <methodname>generate</methodname>()ing the widgets,
	  <methodname>get_element</methodname>() returns the created
	  <classname>&ns;::w::container</classname>.
	</para>
      </listitem>
    </itemizedlist>

    <para>
      <tag class='element'>container</tag>
      creates a &container; and then
      <methodname>generate</methodname>()s the new container from
      another
      <tag class='element'>layout</tag> in the theme file, whose
      <tag class='attribute'>id</tag> is
      <tag class='element'>name</tag>.
      <tag class='element'>type</tag> must be either
      <quote><literal>grid</literal></quote> or
      <quote><literal>book</literal></quote>, and must match the
      <tag class='element'>layout</tag>'s
      <tag class='attribute'>type</tag>.
    </para>

    <para>
      <tag class='element'>container</tag> is
      equivalent to invoking a <tag class='element'>name</tag>d
      <tag class='element'>element</tag>
      callback, and having the callback
      create a new container with the appropriate &layoutmanager;,
      and then <methodname>generate</methodname>()ing its contents
      from the layout specified by the
      <tag class='element'>name</tag> value.
    </para>
  </section>

  <section id="uixmlelementtooltip">
    <title><tag class='element'>tooltip</tag>s</title>
    <blockquote>
      <informalexample>
	<programlisting><![CDATA[
<element id="fixed-canvas" tooltip="canvas-tooltip">

    ...

</element>

<tooltip type="label" id="canvas-tooltip">
    <label type='theme_text'>Click to adjust this color channel&#10;(in the currently selected color)</label>
</tooltip>]]></programlisting>
      </informalexample>
    </blockquote>

    <para>
      <tag class='element'>tooltip</tag>s have unique
      <tag class='attribute'>id</tag>s. The second and subsequent
      <tag class='element'>tooltip</tag>s with the same
      <tag class='attribute'>id</tag> get ignored.
      <tag class='attribute'>type</tag> must always be
      <quote>label</quote>, this is currently ignored but should be set for
      future extensibility.
    </para>

    <para>
      <tag class="element">element</tag>s'
      <tag class='attribute'>tooltip</tag> attribute refers to a tooltip
      with the given
      <tag class='attribute'>id</tag>. More then one
      <tag class='element'>element</tag> may refer to the same tooltip.
    </para>

    <note>
      <para>
	Only &supportedthemewidget;s have a
	<tag class='attribute'>tooltip</tag> attribute;
	&namedwidget;s are under the callbacks'
	control and only the callbacks can set their tooltips.
      </para>
    </note>

    <para>
      <tag class='element'>tooltip</tag>s' contents are the same
      as <link linkend="uixmlfactorylabelelement">label widget</link>'s
      <tag class='element'>label</tag>. This is equivalent to using a widget's
      <methodname>create_tooltip</methodname>() to create a basic,
      label tooltip.
    </para>
  </section>

  <section id="uixmlfactorylabelelement">
    <title>Label <tag class='element'>element</tag> widgets</title>

    <blockquote>
      <informalexample>
	<programlisting><![CDATA[
<element id="directory-label">
  <label type='theme_text'>${context:file-dialog}Directory:</name>
</element>
]]></programlisting>
      </informalexample>
    </blockquote>

    <para>
      Specifying an <tag class='element'>element</tag>
      that contains a <tag class='element'>label</tag>
      creates a new &themewidget;
      which is an
      <ulink url="&link-typedef-x--w-label;"><classname>&ns;::w::label</classname></ulink>
      widget.
      This is equivalent to invoking the &factory;'s
      <methodname>create_label</methodname>() method.
    </para>

    <para>
      The contents of the
      <tag class='element'>label</tag> is a &text_paramvalue;.
    </para>

    <section id="uixmllabelconfig">
      <title>Specifying label options</title>

      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<element id="title">
    <label type="theme_text">Lorem Ipsum ... est laborum.</label>
    <options>
        <alignment>center</alignment>
        <widthmm>40</widthmm>
    </options>
</element>]]></programlisting>
	</informalexample>
      </blockquote>

      <para>
	An optional <tag class="element">options</tag> element of a
	<tag class="element">label</tag> element specifies the values
	of a <ulink url="&link-x--w--label-config;"><classname>&ns;::w::label_config</classname></ulink>
	for creating the label widget.
      </para>
    </section>
  </section>

  <section id="uixmlfactorycanvaselement">
    <title>Canvas <tag class='element'>element</tag> widgets</title>

    <blockquote>
      <informalexample>
	<programlisting><![CDATA[
<dim id="strip_width">10</dim>
<dim id="strip_height">10</dim>

<element id="fixed-canvas">
    <canvas>
        <background_color>white</background>
	<width>strip_width</width>
	<height>strip_height</height>
    </canvas>
</element>]]></programlisting>
      </informalexample>
    </blockquote>

    <para>
      Specifying an <tag class='element'>element</tag>
      that contains a <tag class='element'>canvas</tag>
      creates a new &themewidget;
      which is an
      <ulink url="&link-typedef-x--w-canvas;"><classname>&ns;::w::canvas</classname></ulink>
      widget.
      This is equivalent to invoking the &factory;'s
      <methodname>create_canvas</methodname>() method.
    </para>

    <para>
      The contents of the <tag class='element'>canvas</tag> set the values
      of <methodname>create_canvas</methodname>()'s
      <ulink url="&link-x--w--canvas-config;"><classname>&ns;::w::canvas_config</classname></ulink>
      parameter:
    </para>

    <variablelist>
      <varlistentry>
	<term>
	  <tag class='element'>background_color</tag>
	</term>
	<listitem>
	  <para>
	    References a <link linkend="uixmldimcolorborders"><tag class='element'>color</tag></link>
	    in the theme file, defining the canvas's background color.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <tag class='element'>minimum_width</tag>,
	  <tag class='element'>preferred_width</tag>,
	  <tag class='element'>maximum_width</tag>,
	  <tag class='element'>minimum_height</tag>,
	  <tag class='element'>preferred_height</tag>, and
	  <tag class='element'>maximum_height</tag>
	</term>
	<listitem>
	  <para>
	    These elements reference other
	    <link linkend="uixmldimcolorborders"><tag class='element'>dim</tag></link>s
	    in the theme file, defining the canvas's size.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <tag class='element'>width</tag>
	</term>
	<listitem>
	  <para>
	    This is equivalent to defining the same minimum, preferred,
	    and maximum width.
	  </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>
	  <tag class='element'>height</tag>
	</term>
	<listitem>
	  <para>
	    This is equivalent to defining the same minimum, preferred,
	    and maximum height.
	  </para>
	</listitem>
      </varlistentry>
    </variablelist>
  </section>

  <section id="uixmlfactoryfocusablelabelelement">
    <title>Focusable label <tag class='element'>element</tag> widgets</title>

    <blockquote>
      <informalexample>
	<programlisting><![CDATA[
<element id="directory-name">
  <focusable_label type='theme_text'>Top Level Directory</focusable_label>

  <options>
     <widthmm>40</widthmm>
     <focus_border>custom</focus_border>
  </otions>
</element>]]></programlisting>
      </informalexample>
    </blockquote>

    <para>
      Specifying an <tag class='element'>element</tag>
      with a <tag class='element'>focusable_label</tag>
      creates a new &themewidget;
      which is an
      <ulink url="&link-typedef-x--w-focusable-label;"><classname>&ns;::w::focusable_label</classname></ulink>
      widget.
      This is equivalent to invoking the &factory;'s
      <methodname>create_focusable_label</methodname>() method.
    </para>

    <para>
      The <tag class='element'>focusable_label</tag> element has the same
      contents as a
      <link linkend="uixmlfactorylabelelement"><tag class='element'>label</tag>
	element</link>, with an additional
      <tag class='element'>options</tag> setting.
      <tag class='element'>options</tag> initializes the
      <ulink url="&link-x--w--focusable-label-config;"><classname>&ns;::w::focusable_label_config</classname></ulink>
      parameter for <methodname>create_focusable_label</methodname>, which has
      the same members as
      <tag class='element'>label</tag>'s
      <ulink url="&link-x--w--label-config;"><classname>&ns;::w::label_config</classname></ulink>,
      with an additional
      <tag class='element'>focus_border</tag> that sets the focusable
      label's
      <link linkend="uixmlappearance">appearance object</link>.
    </para>
  </section>

  <section id="uixmlfactorybuttonelement">
    <title>Button <tag class='element'>element</tag> widgets</title>
    <blockquote>
      <informalexample>
	<programlisting><![CDATA[
<element id="help-button">
  <button>
    <element id="h-canvas">
      <label type="theme_text">Help</label>
    </element>
  </button>
  <config>
    <appearance>default_theme</appearance>
  </config>
  <shortcut>Alt-H</shortcut>
</element>]]></programlisting>
      </informalexample>
    </blockquote>

    <para>
      Specifying an <tag class='element'>element</tag>
      with a <tag class='element'>button</tag>
      creates a new &themewidget;
      which is an
      <ulink url="&link-typedef-x--w-button;"><classname>&ns;::w::button</classname></ulink>
      widget.
      This is equivalent to invoking the &factory;'s
      <methodname>create_button</methodname>() method.
    </para>

    <para>
      The <tag class='element'>button</tag> contains a &themewidgetorcontainer;
      that creates the contents of the button, usually a
      <link linkend="uixmlfactorylabelelement"><tag class='element'>label</tag>
	element</link>.
    </para>

    <para>
      An optional <tag class='element'>config</tag> value sets
      <methodname>create_button</methodname>()'s
      <ulink url="&link-x--w--button-config;"><classname>&ns;::w::button_config</classname></ulink>
      parameter, and an
      optional <tag class='element'>shortcut</tag> contains the
      button's
      &keyboard_shortcutvalue;.
    </para>
  </section>

  <section id="uixmlfactoryinputfieldelement">
    <title>Input field <tag class='element'>element</tag> widgets</title>
    <blockquote>
      <informalexample>
	<programlisting><![CDATA[
<element id='number-of-copies'>
  <input_field>1</input_field>
  <config>
    <columns>6</columns>
    <alignment>right</alignment>
    <maximum_size>5</maximum_size>
    <autoselect />
    <set_default_spin_control_factories />
  </config>
</element>]]></programlisting>
      </informalexample>
    </blockquote>

    <para>
      Specifying an <tag class='element'>element</tag>
      with a <tag class='element'>input_field</tag>
      creates a new &themewidget;
      which is an
      <ulink url="&link-typedef-x--w-input-field;"><classname>&ns;::w::input_field</classname></ulink>
      widget.
      This is equivalent to invoking the &factory;'s
      <methodname>create_input_field</methodname>() method.
    </para>

    <para>
      The value of the <tag class='element'>input_field</tag> sets the initial
      contents of the input field (the first parameter to
      <methodname>create_input_field</methodname>()). It may be empty:
    </para>
    <blockquote>
      <informalexample>
	<programlisting><![CDATA[
<input_field />]]></programlisting>
      </informalexample>
    </blockquote>

    <note>
      <para>
	<tag class='element'>input_field</tag> element's value is a
	&text_paramvalue;, the first parameter to
	<methodname>create_input_field</methodname>(); this sets the
	input field's initial contents (fonts, colors, and other visual
	markup references are not allowed,
	of course, and any literal <quote>$</quote> should be doubled as
	<quote>$$</quote>).
      </para>
    </note>

    <para>
      An optional <tag class='element'>config</tag> element initializes the
      <ulink url="&link-x--w--input-field-config;"><classname>&ns;::w::input_field_config</classname></ulink>
      parameter for <methodname>create_input_field</methodname>, as
      follows:
    </para>

    <variablelist>
      <varlistentry>
	<term>
	  <tag class='element'>columns</tag>,
	  <tag class='element'>rows</tag>, and
	  <tag class='element'>maximum_size</tag>
	</term>
	<listitem>
	  <para>
	    Sets the corresponding members in the
	    <classname>&ns;::w::input_field_config</classname>
	    parameter.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <tag class='emptytag'>autoselect</tag> and
	  <tag class='emptytag'>autodeselect</tag>
	</term>
	<listitem>
	  <para>
	    Sets the corresponding flags in the
	    <classname>&ns;::w::input_field_config</classname>
	    parameter.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <tag class='emptytag'>disable_clipboards</tag>
	</term>
	<listitem>
	  <para>
	    Sets
	    <classname>&ns;::w::input_field_config</classname>'s
	    <varname>update_clipboards</varname> to <literal>false</literal>.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <tag class='element'>hint</tag>
	</term>
	<listitem>
	  <para>
	    Sets the
	    <classname>&ns;::w::input_field_config</classname>'s
	    <varname>hint</varname> &text_paramvalue;.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <tag class='emptytag'>password</tag>
	</term>
	<listitem>
	  <para>
	    Invokes <classname>&ns;::w::input_field_config</classname>'s
	    <methodname>set_password</methodname>() method, configuring this
	    input field as a <link linkend="passwordfields">password
	      input field</link>.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <tag class='emptytag'>set_default_spin_control_factories</tag>
	</term>
	<listitem>
	  <para>
	    Invokes <classname>&ns;::w::input_field_config</classname>'s
	    <methodname>set_default_spin_control_factories</methodname>()
	    method, enabling this
	    input field's <link linkend="spininput">spin buttons</link>.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <tag class='emptytag'>enable_search</tag>
	</term>
	<listitem>
	  <para>
	    Invokes <classname>&ns;::w::input_field_config</classname>'s
	    <methodname>enable_search</methodname>()
	    method, enabling this
	    input field's <link linkend="searchwidgets">search popup</link>.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <tag class='element'>vertical_scrollbar</tag>
	</term>
	<listitem>
	  <para>
	    This element contains an &scrollbar_visibilityvalue; that sets
	    the corresponding
	    member of ths
	    <ulink url="&link-x--w--input-field-config;"><classname>&ns;::w::input_field_config</classname></ulink>
	    parameter.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <tag class='element'>alignment</tag>
	</term>
	<listitem>
	  <para>
	    This element contains an &halignvalue; that sets the corresponding
	    member of ths
	    <ulink url="&link-x--w--input-field-config;"><classname>&ns;::w::input_field_config</classname></ulink>
	    parameter.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <tag class='element'>appearance</tag>
	</term>
	<listitem>
	  <para>
	    Sets the input field's
	    <link linkend="uixmlappearance"><varname>appearance</varname></link>
	    object.
	  </para>
	</listitem>
      </varlistentry>
    </variablelist>
  </section>


  <section id="uixmlfactorydateinputfieldelement">
    <title>Date input field <tag class='element'>element</tag> widgets</title>
    <blockquote>
      <informalexample>
	<programlisting><![CDATA[
<element id="starting_date">
  <date_input_field />
  <config>
    <invalid_input type='theme_text'>Starting date is not valid</invalid_input>
  </config>
</element>]]></programlisting>
      </informalexample>
    </blockquote>
    <para>
      Specifying an <tag class='element'>element</tag>
      with a <tag class='emptytag'>date_input_field</tag>
      creates a new &themewidget;
      which is an
      <ulink url="&link-typedef-x--w-date-input-field;"><classname>&ns;::w::date_input_field</classname></ulink>
      widget.
      This is equivalent to invoking the &factory;'s
      <methodname>create_date_input_field</methodname>() method.
    </para>

    <para>
      An optional <tag class='element'>config</tag> element initializes the
      <ulink url="&link-x--w--date-input-field-config;"><classname>&ns;::w::date_input_field_config</classname></ulink>
      parameter for <methodname>create_date_input_field</methodname>, as
      follows:
    </para>

    <variablelist>
      <varlistentry>
	<term>
	  <tag class='element'>invalid_input</tag>
	</term>
	<listitem>
	  <para>
	    Sets the
	    <classname>&ns;::w::date_input_field_config</classname>'s
	    <varname>invalid_input</varname> &text_paramvalue;.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <tag class='element'>appearance</tag>
	</term>
	<listitem>
	  <para>
	    Sets the date input field's
	    <link linkend="uixmlappearance"><varname>appearance</varname></link>
	    object.
	  </para>
	</listitem>
      </varlistentry>
    </variablelist>
  </section>

  <section id="uixmlfactoryimageelement">
    <title>Image <tag class='element'>element</tag> widgets</title>
    <blockquote>
      <informalexample>
	<programlisting><![CDATA[
<element>
   <image>radio2</image>
   <width>radio-width</width>
   <height>radio-height</height>
</element>

<!-- ... -->

<dim id="radio-width">10</dim>
<dim id="radio-height">10</dim>]]></programlisting>
      </informalexample>
    </blockquote>
    <para>
      Specifying an <tag class='element'>element</tag>
      with a <tag class='element'>image</tag>
      creates a new &themewidget;
      which is an
      <ulink url="&link-typedef-x--w-image;"><classname>&ns;::w::image</classname></ulink>
      widget.
      This is equivalent to invoking the &factory;'s
      <methodname>create_image</methodname>() method.
    </para>

    <para>
      The value of the <tag class='element'>image</tag> element is the
      first parameter to <methodname>create_image</methodname>(), the image
      file.
      The values of optional <tag class='element'>width</tag> and
      <tag class='element'>height</tag> elements
      are <tag class='attribute'>id</tag>s of
      <link linkend="uixmldimcolorborders"><tag class='element'>dim</tag></link>s
      in the them file. They are only used when the
      <tag class='element'>image</tag> is an
      <link linkend="sxg">&sxg; file</link>
      and specifies the size the &sxg; image gets scaled to.
    </para>
  </section>

  <section id="uixmlfactorycheckboxelement">
    <title>Checkbox <tag class='element'>element</tag> widgets</title>
    <blockquote>
      <informalexample>
	<programlisting><![CDATA[
<element id="full-precision">
  <checkbox>
    <element>
      <label type="theme_text">Full Precision</label>
    </element>
  </checkbox>
</element>]]></programlisting>
      </informalexample>
    </blockquote>

    <para>
      Specifying an <tag class='element'>element</tag>
      with a <tag class='element'>checkbox</tag>
      creates a new &themewidget;
      which is an
      <ulink url="&link-typedef-x--w-image-button;"><classname>&ns;::w::image_button</classname></ulink>
      checkbox widget.
      This is equivalent to invoking the &factory;'s
      <methodname>create_checkbox</methodname>() method.
    </para>

    <para>
      The <tag class='element'>checkbox</tag> contains a &themewidgetorcontainer;
      that creates the contents of the button, usually a
      <link linkend="uixmlfactorylabelelement"><tag class='element'>label</tag>
	element</link>.
    </para>

    <para>
      An optional <tag class='element'>appearance</tag> value provides
      <methodname>create_checkbox</methodname>()'s
      optional <classname>&ns;::w::const_image_button_appearance</classname>
      parameter.
      The value of the <tag class='element'>appearance</tag> element
      is a <tag class="attribute">type</tag>=<quote>image_button</quote>
      <link linkend="uixmlappearance">appearance object</link> from the
      theme file.
    </para>
  </section>

  <section id="uixmlappearance">
    <title><tag class='element'>appearance</tag>s</title>

    <mediaobject>
      <imageobject>
	<imagedata fileref="uigenerator3.png" format="PNG"
		   contentwidth="266px" contentdepth="206px" />
      </imageobject>
      <textobject>
	<phrase>
	  Creating custom &appearance_object;s
	</phrase>
      </textobject>
      <caption>
	<para>
	  Each <tag class='element'>appearance</tag> creates a custom
	  &appearance_object;.
	  <ulink url="examples/uigenerator3.C"><filename>uigenerator3.C</filename></ulink>
	  creates a <link linkend="checkradio">checkbox</link> with a custom
	  visual appearance. The default checkbox image gets replaced with
	  a chevron that alternates between pointing left and right, with
	  a large, blocky input focus frame around it.
	</para>
      </caption>
    </mediaobject>

    <blockquote>
      <title><ulink url="examples/uigenerator3.xml">uigenerator3.xml</ulink></title>

      <informalexample>
	<programlisting><xi:include href="../examples/uigenerator3.xml" parse="text" xmlns:xi="http://www.w3.org/2001/XInclude" /></programlisting>
      </informalexample>
    </blockquote>

    <para>
      Each <tag class='element'>appearance</tag> must have a unique
      <tag class='attribute'>id</tag> and a valid
      <tag class='attribute'>type</tag>. The first occurence of an
      <tag class='element'>appearance</tag> with a designated
      <tag class='attribute'>id</tag> takes effect, and subsequent
      <tag class='element'>appearance</tag>s with the same
      <tag class='attribute'>id</tag> get ignored.
    </para>

    <section id="uixmlappearanceusing">
      <title>Creating and using <tag class='element'>appearance</tag> objects</title>
      <blockquote>
	<informalexample>
	  <programlisting>
auto generator=&ns;::w::const_uigenerators::create("uigenerator3.xml");

// ...

factory-&gt;create_checkbox(generator-&gt;lookup_appearance("custom-checkbox"));</programlisting>
	</informalexample>
      </blockquote>

      <para>
	A <link linkend="uixmlgenerate">generator</link>'s
	<methodname>lookup_appearance</methodname> returns an appearance
	object specified by its <quote>id</quote>. This theme file creates
	an appearance object named <quote>custom-checkbox</quote>, and
	<methodname>lookup_appearance</methodname>() returns it. This gets
	passed to a &factory;'s <methodname>create_checkbox</methodname>()
	that takes an optional appearance object as a parameter, and this
	sets the new checkbox's appearance using the specified appearance
	object.
      </para>

      <para>
	<methodname>lookup_appearance</methodname>() returns a generatic
	<classname>&ns;;::w::const_appearance</classname> object from which
	all appearance objects get derived from. The following table lists
	all appearance object classes and the
	<tag class='attribute'>type</tag>s which create them.
      </para>

      <para>
	<tag class='element'>appearance</tag> 's optional
	<tag class='element'>from</tag> attribute specifies another,
	<quote>parent</quote>
	<tag class='element'>appearance</tag> that this
	<tag class='element'>appearance</tag> gets based from.
	The following table lists all available appearance
	<tag class='attribute'>type</tag>s, and the resulting appearance
	object class.
	<tag class='attribute'>from</tag> specifies either:
      </para>

      <itemizedlist>
	<listitem>
	  <para>
	    The <tag class='attribute'>id</tag> of another, parent
	    appearance object.
	  </para>
	</listitem>

	<listitem>
	  <para>
	    One of the built-in themes from the following table.
	    The default built-in theme gets used when a
	    <tag class='attribute'>from</tag> parent does not get
	    specified.
	  </para>
	</listitem>
      </itemizedlist>
      &uixmlappearance_list;
    </section>

    <section id="uixmlappearancefields">
      <title>Contents of <tag class='element'>appearance</tag>s in theme files</title>
      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<appearance id="custom-checkbox-focus-border" type="focus_border">
  <focusoff_border>custom-focusoff</focusoff_border>
  <focuson_border>custom-focuson</focuson_border>
</appearance>]]></programlisting>
	</informalexample>
      </blockquote>

      <para>
	Each
	<tag class='element'>appearance</tag> contains elements whose names
	match the names of the fields in the corresponding appearance classes.
	A <ulink url="&link-x--w--focus-border-appearance-properties;">focus
	  border appearance object</ulink> contains two fields,
	<varname>focusoff_border</varname>, and
	<varname>focuson_border</varname>, and an
	<tag class='element'>appearance</tag> with a
	<literal>focus_border</literal> <tag class='attribute'>type</tag>
	specifies their values accordingly.
      </para>

      <para>
	If not explicitly specified,
	the value of each field comes from the parent
	<tag class='element'>appearance</tag>, explicitly specified by the
	<tag class='attribute'>from</tag> attribute, or the default parent.
      </para>

      <para>
	The fields get specified as follows:
      </para>

      <variablelist>
	<varlistentry>
	  <term>
	   <classname>std::string</classname> fields
	  </term>
	  <listitem>
	    <blockquote>
	      <informalexample>
		<programlisting><![CDATA[
<images>scroll-left1</images>
]]></programlisting>
	      </informalexample>
	    </blockquote>
	    <para>
	      <classname>std::string</classname> values get specified directly.
	    </para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term>
	    <ulink url="&link-typedef-x--w-border-arg;"><classname>&ns;::w::border_arg</classname></ulink> fields
	  </term>
	  <listitem>
	    <blockquote>
	      <informalexample>
		<programlisting><![CDATA[
<focuson_border>custom-focuson</focuson_border>
]]></programlisting>
	      </informalexample>
	    </blockquote>
	    <para>
	      <classname>&ns;::w::border_arg</classname> values are
	      are <tag class='attribute'>id</tag>s of
	      <tag class='element'>border</tag>s in the theme file. They
	      may also reference border <tag class='attribute'>id</tag>s
	      from the current display theme, but this is not documented.
	      A more future-proof way of borrowing a standard theme border
	      is to use one of the built-in theme appearance objects as
	      the parent object and
	      not changing the existing
	      <classname>&ns;::w::border_arg</classname> value.
	    </para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term>
	    <ulink url="&link-typedef-x--w-color-arg;"><classname>&ns;::w::color_arg</classname></ulink>
	    and <ulink url="&link-typedef-x--w-text-color-arg;"><classname>&ns;::w::text_color_arg</classname></ulink>
	    fields
	  </term>
	  <listitem>
	    <blockquote>
	      <informalexample>
		<programlisting><![CDATA[
<color2>focuson2</color2>
]]></programlisting>
	      </informalexample>
	    </blockquote>
	    <para>
	      Color values are
	      are <tag class='attribute'>id</tag>s of
	      <tag class='element'>color</tag>s in the theme file. They
	      may also reference border <tag class='attribute'>id</tag>s
	      from the current display theme, but this is not documented.
	      A more future-proof way of borrowing a standard theme border
	      is to use one of the built-in theme appearance objects as
	      the parent object and
	      not changing the existing color value.
	    </para>

	    <para>
	      Color values may also reference
	      <link linkend="uixmlderivedvalues">standard HTML 3.2
		colors</link>.
	    </para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term>
	    <ulink url="&link-typedef-x--w-dim-arg;"><classname>&ns;::w::dim_arg</classname></ulink> fields
	  </term>
	  <listitem>
	    <blockquote>
	      <informalexample>
		<programlisting><![CDATA[
  <dim id="cell-padding">20</dim>
]]></programlisting>
	      </informalexample>
	    </blockquote>
	    <para>
	      <classname>&ns;::w::dim_arg</classname> values are
	      are <tag class='attribute'>id</tag>s of
	      <tag class='element'>dim</tag>s in the theme file. They
	      may also reference border <tag class='attribute'>id</tag>s
	      from the current display theme, but this is not documented.
	      A more future-proof way of borrowing a standard theme border
	      is to use one of the built-in theme appearance objects as
	      the parent object and
	      not changing the existing
	      <classname>&ns;::w::dim_arg</classname> value.
	    </para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term>
	    <ulink url="&link-typedef-x--w-font-arg;"><classname>&ns;::w::font_arg</classname></ulink> fields
	  </term>
	  <listitem>
	    <blockquote>
	      <informalexample>
		<programlisting><![CDATA[
<shortcut_font>small</shortcut_font>
]]></programlisting>
	      </informalexample>
	    </blockquote>
	    <para>
	      <classname>&ns;::w::font_arg</classname> values are
	      are <tag class='attribute'>id</tag>s of
	      <tag class='element'>font</tag>s in the theme file. They
	      may also reference border <tag class='attribute'>id</tag>s
	      from the current display theme, but this is not documented.
	      A more future-proof way of borrowing a standard theme border
	      is to use one of the built-in theme appearance objects as
	      the parent object and
	      not changing the existing
	      <classname>&ns;::w::font_arg</classname> value.
	    </para>

	    <para>
	      See <xref linkend="sxgfonts" /> for more information on how
	      to define custom <tag class='element'>font</tag>s.
	    </para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term>
	    <ulink url="&link-enum-x--w-halign;"><classname>&ns;::w::halign</classname></ulink> fields
	  </term>
	  <listitem>
	    <blockquote>
	      <informalexample>
		<programlisting><![CDATA[
<horizontal_alignment>center</horizontal_alignment>
]]></programlisting>
	      </informalexample>
	    </blockquote>
	    <para>
	      These fields contain &halignvalue;s.
	    </para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term>
	    <ulink url="&link-enum-x--w-scrollbar-visibility;"><classname>&ns;::w::scrollbar_visibility</classname></ulink> fields
	  </term>
	  <listitem>
	    <blockquote>
	      <informalexample>
		<programlisting><![CDATA[
<pane_scrollbar_visibility>automatic</pane_scrollbar_visibility>
]]></programlisting>
	      </informalexample>
	    </blockquote>
	    <para>
	      These fields contain &scrollbar_visibilityvalue;s.
	    </para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term>
	    <ulink url="&link-x--w--text-param;"><classname>&ns;::w::text_param</classname></ulink> fields
	  </term>
	  <listitem>
	    <blockquote>
	      <informalexample>
		<programlisting><![CDATA[
<font id="ok_font">
  <family>liberation mono</family>
  <point_size>18</point_size>
</font>


<ok_label>${font:ok_font}Ok</ok_label>
]]></programlisting>
	      </informalexample>
	    </blockquote>
	    <para>
	      These fields contain &text_paramvalue;s.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term>
	    <ulink url="&link-enum-x--w-valign;"><classname>&ns;::w::valign</classname></ulink> fields
	  </term>
	  <listitem>
	    <blockquote>
	      <informalexample>
		<programlisting><![CDATA[
<vertical_alignment>middle</vertical_alignment>
]]></programlisting>
	      </informalexample>
	    </blockquote>
	    <para>
	      These fields contain &valignvalue;s.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term>
	    <classname>&ns;::w::const_<replaceable>type</replaceable>_apperance</classname> fields
	  </term>
	  <listitem>
	    <blockquote>
	      <informalexample>
		<programlisting><![CDATA[
<focus_border>custom-checkbox-focus-border</focus_border>
]]></programlisting>
	      </informalexample>
	    </blockquote>
	  </listitem>
	  <para>
	    Appearance object can contain other appearance objects, as their fields.
	    Example: the <varname>focus_border</varname> field in an
	    <ulink url="&link-x--w--image-button-appearance-properties;">image button appearance</ulink>
	    object is a
	    <ulink url="&link-x--w--focus-border-appearance-properties;">focus border appearance</ulink>
	    object.
	    The value of this field ia an
	    <tag class='attribute'>id</tag>s of another
	    <tag class='element'>appearance</tag> widget, with the appropriate type,
	    in the theme file.
	  </para>
	</varlistentry>
      </variablelist>
    </section>
    <section id="uixmlappearanceoptionalvectorfields">
      <title><classname>std::optional</classname> and <classname>std::vector</classname> fields</title>
      <blockquote>
	<informalexample>
	  <programlisting><![CDATA[
<images>
  <reset />
</images>

<images>scroll-left1</images>
<images>scroll-right1</images>
]]></programlisting>
	</informalexample>
      </blockquote>

      <para>
	A new
	<tag class='element'>appearance</tag> widget starts with the values of all fields
	copied from its parent appearance object, then each value in the
	<tag class='element'>appearance</tag> widget replaces the value of the
	corresponding field in the
	new appearance object.
	Some fields in appearance objects are <classname>std::optional</classname> or
	<classname>std::vector</classname>s.
	Each value of a
	<classname>std::vector</classname> field gets appended to a vector.
	Specifying a
	<tag class='element'>reset</tag> for a
	<classname>std::vector</classname> value
	<methodname>erase</methodname>()s its existing contents.
	Specifying a
	<tag class='element'>reset</tag> for a
	<classname>std::optional</classname> <methodname>reset</methodname>()s its value.
      </para>

      <para>
	New values of a <classname>std::vector</classname> usually gets specified after
	<tag class='element'>reset</tag>ing the values it inherited from its parent
	appearance object.
      </para>
    </section>
  </section>
</appendix>

<!--
Local Variables:
mode: sgml
sgml-parent-document: ("book.xml" "book" "appendix")
End:
-->
